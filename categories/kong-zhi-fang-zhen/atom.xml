<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
    <title>xsro&#x27;s blog - 控制仿真</title>
    <link rel="self" type="application/atom+xml" href="https://xsro.github.io/categories/kong-zhi-fang-zhen/atom.xml"/>
    <link rel="alternate" type="text/html" href="https://xsro.github.io"/>
    <generator uri="https://www.getzola.org/">Zola</generator>
    <updated>2022-08-09T00:00:00+00:00</updated>
    <id>https://xsro.github.io/categories/kong-zhi-fang-zhen/atom.xml</id>
    <entry xml:lang="en">
        <title>计算机辅助控制系统设e = 简介与回顾</title>
        <published>2022-08-09T00:00:00+00:00</published>
        <updated>2022-08-09T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://xsro.github.io/control/control-system-cad-cn/"/>
        <id>https://xsro.github.io/control/control-system-cad-cn/</id>
        
        <content type="html" xml:base="https://xsro.github.io/control/control-system-cad-cn/">&lt;h2 id=&quot;yuan-wen-xin-xi&quot;&gt;原文信息&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Varga, A. (2020). Computer-Aided Control Systems Design = Introduction and Historical Overview. In = Baillieul, J., Samad, T. (eds) Encyclopedia of Systems and Control. Springer, London. https:&#x2F;&#x2F;doi.org&#x2F;10.1007&#x2F;978-1-4471-5102-9_138-3&lt;&#x2F;li&gt;
&lt;li&gt;First Online = 08 November 2019&lt;&#x2F;li&gt;
&lt;li&gt;Source = &lt;a href=&quot;https:&#x2F;&#x2F;link.springer.com&#x2F;referenceworkentry&#x2F;10.1007&#x2F;978-1-4471-5102-9_138-3&quot;&gt;springer&lt;&#x2F;a&gt;, &lt;a href=&quot;https:&#x2F;&#x2F;core.ac.uk&#x2F;download&#x2F;pdf&#x2F;31011908.pdf&quot;&gt;pdf&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;Author = Andreas Varga&lt;&#x2F;li&gt;
&lt;li&gt;Institution = German Aerospace Center, DLR Oberpfaffenhofen Institute of System Dynamics and Control&lt;&#x2F;li&gt;
&lt;li&gt;email = Andreas.Varga@dlr.de&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;see &lt;a href=&quot;&#x2F;control&#x2F;control-system-cad&#x2F;&quot;&gt;a copy of original article&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;zhai-yao&quot;&gt;摘要&lt;&#x2F;h2&gt;
&lt;p&gt;计算机辅助控制系统设计（ Computer-aided control system design ，CACSD）包含的领域非常广泛，
其包括用于系统模拟、控制系统合成与整定、动态系统分析与模拟，以及认证与验证等工作的方法，工具与技术。
近些年来，CACSD 所覆盖的领域有了进一步的拓展，
其从应用于控制系统分析与整合的算法程序的简单集合
发展为能够支撑各个应用领域先进控制系统开发部署等各个方面的完整工具集以及用户友好的开发环境。
本文给出了 CACSD 的简要介绍，同时回顾 CACSD 领域关键概念与技术的演化。
其中将重点介绍在开发可依赖数值算法，实现鲁棒数值分析软件以及开发随机交互模型、仿真与设计环境的一些支柱性成就。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;关键词（短语）&lt;&#x2F;strong&gt;：
CACSD,
仿真,
建模,
数值分析,
软件工具&lt;&#x2F;p&gt;
&lt;h2 id=&quot;jian-jie&quot;&gt;简介&lt;&#x2F;h2&gt;
&lt;p&gt;为了给一个对象(plant)设计一个控制系统，典型的计算机辅助控制系统设计(CACSD)工作流程包括多个交错的工作。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;模型建立&lt;&#x2F;strong&gt;通常是建立适合准确描述被控对象动态行为的数学模型所必须的第一步&lt;&#x2F;p&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Computer-Aided Control Systems Design = Introduction and Historical Overview</title>
        <published>2022-08-09T00:00:00+00:00</published>
        <updated>2022-08-09T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://xsro.github.io/control/control-system-cad/"/>
        <id>https://xsro.github.io/control/control-system-cad/</id>
        
        <content type="html" xml:base="https://xsro.github.io/control/control-system-cad/">&lt;h2 id=&quot;infomation&quot;&gt;infomation&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Varga, A. (2020). Computer-Aided Control Systems Design = Introduction and Historical Overview. In = Baillieul, J., Samad, T. (eds) Encyclopedia of Systems and Control. Springer, London. https:&#x2F;&#x2F;doi.org&#x2F;10.1007&#x2F;978-1-4471-5102-9_138-3&lt;&#x2F;li&gt;
&lt;li&gt;Source = &lt;a href=&quot;https:&#x2F;&#x2F;link.springer.com&#x2F;referenceworkentry&#x2F;10.1007&#x2F;978-1-4471-5102-9_138-3&quot;&gt;springer&lt;&#x2F;a&gt;, &lt;a href=&quot;https:&#x2F;&#x2F;core.ac.uk&#x2F;download&#x2F;pdf&#x2F;31011908.pdf&quot;&gt;pdf&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;First Online = 08 November 2019&lt;&#x2F;li&gt;
&lt;li&gt;Author = Andreas Varga&lt;&#x2F;li&gt;
&lt;li&gt;Institution = German Aerospace Center, DLR Oberpfaffenhofen Institute of System Dynamics and Control&lt;&#x2F;li&gt;
&lt;li&gt;email = Andreas.Varga@dlr.de&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h2 id=&quot;abstract&quot;&gt;Abstract&lt;&#x2F;h2&gt;
&lt;p&gt;Computer-aided control system design (CACSD) encompasses a broad range of methods, tools and technologies
for system modelling, control system synthesis and tuning, dynamic system analysis and simulation, as well as validation and verification.
The domain of CACSD enlarged progressively over decades
from simple collections of algorithms and programs for control system analysis and synthesis,
to comprehensive tool sets and user-friendly environments supporting all aspects of developing and deploying advanced control systems in various application fields.
This article gives a brief introduction to CACSD and reviews the evolution of key concepts and technologies underlying the CACSD domain.
Several cornerstone achievements in developing reliable numerical algorithms, implementing robust numerical software and developing sophisticated integrated modelling, simulation and design environments are highlighted.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;Keywords and Phrases&lt;&#x2F;strong&gt;:
CACSD,
simulation,
modeling,
numerical analysis,
software tools&lt;&#x2F;p&gt;
&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;&#x2F;h2&gt;
&lt;p&gt;To design a control system for a plant, a typical computer-aided control system design (CACSD) work flow comprises several interlaced activities.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;Model building&lt;&#x2F;strong&gt; is often a necessary first step consisting in developing suitable mathematical models to accurately describe the plant dynamical behaviour.
High-fidelity physical plant models, obtained for example by using first principles modelling, primarily serve for analysis and validation purposes using appropriate simulation techniques.
These dynamic models are usually defined by a set of ordinary differential equations (ODEs), differential-algebraic equation (DAEs) or partial differential equations (PDEs).
However, for control system synthesis purposes simpler models are required, which are derived by simplifying high-fidelity models (e.g., by linearization, discretization, or model reduction) or directly determined in a specific form from input-output measurement data using system identification techniques.
Frequently used synthesis models are continuous or discrete-time linear time-invariant (LTI) models describing the nominal behaviour of the plant in a specific operating point.
The more accurate linear parameter varying (LPV) models may serve to account for uncertainties due to various performed approximations, nonlinearities or varying model parameters.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;Simulation&lt;&#x2F;strong&gt; of dynamical systems is a closely related activity to modelling and is concerned with performing virtual experiments on a given plant model to analyse and predict the dynamic behaviour of a physical plant.
Often modelling and simulation are closely connected parts of dedicated environments, where specific classes of models can be built and appropriate simulation methods can be employed.
Simulation is also a powerful tool for the validation of mathematical models and their approximations.
In the context of CACSD, simulation is frequently used as a control system tuning-aid, as, for example, in an optimization-based tuning approach using timedomain performance criteria.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;System analysis and synthesis&lt;&#x2F;strong&gt; are concerned with with the investigation of properties of the underlying synthesis model and in the determination of a control system which fulfills basic requirements for the closed-loop controlled plant, such as stability or various time or frequency response requirements.
The analysis also serves to check existence conditions for the solvability of synthesis problems, according to established design methodologies.
An important synthesis goal is the guarantee of the performance robustness.
To achieve this goal robust control synthesis methodologies often employ optimization-based parameter tuning in conjunction with worst-case analysis techniques.
A rich collection of reliable numerical algorithms are available to perform such analysis and synthesis tasks.
These algorithms form the core of CACSD and their development represented one of
the main motivations for CACSD-related research.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;Performance robustness assessment&lt;&#x2F;strong&gt; of the resulting closed-loop control system is a key aspect of the verification and validation activity.
For a reliable assessment, simulation-based worst-case analysis represents often the only way to prove the performance robustness of the synthesized control system in the
presence of parametric uncertainties and variabilities.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;development-of-cacsd-tools&quot;&gt;Development of CACSD tools&lt;&#x2F;h2&gt;
&lt;p&gt;The development of CACSD tools for system analysis and synthesis started around 1960, immediately after general purpose digital computers and new programming languages became available for research and development purposes.
In what follows we give a historical survey of these developments in the main CACSD areas.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;modelling-and-simulation-tools&quot;&gt;Modelling and simulation tools&lt;&#x2F;h3&gt;
&lt;p&gt;Among the first developments were modelling and simulation tools for continuous-time systems described by differential equations based on dedicated simulation languages.
Over forty continuous-system simulation languages had been developed as of 1974 &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#nilsen1974&quot;&gt;1&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;, which evolved out of attempts at digitally emulating the behaviour of widely used analog computers before 1960.
A notable development in this period was the CSSL standard &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#augustin1967&quot;&gt;2&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;, which defined a system as an interconnection of blocks corresponding to operators which emulated the main analog simulation blocks and implied the integration of the underlying ODEs using suitable numerical methods.
For many years, the ACSL preprocessor to Fortran &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#mitchel1976&quot;&gt;3&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; was one of the most successful implementations of the CSSL-standard.&lt;&#x2F;p&gt;
&lt;p&gt;A turning point was the development of graphical user interfaces allowing graphical block-diagram based modelling.
The most important developments were SystemBuild &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#shah1985&quot;&gt;4&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; and SIMULAB (later marketed as Simulink) &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#grace1991&quot;&gt;5&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;.
Both products used a customizable set of block libraries and were seamlessly integrated in, respectively, MATRIXx and MATLAB, two powerful interactive matrix computation environments (see below).
SystemBuild provided several advanced features such as event management, code generation, and DAE-based modelling and simulation.
Simulink excelled from the beginning with its intuitive, easy-to-use user interface. Recent extensions of Simulink allow the modelling and simulation of hybrid systems, code generation for real-time applications, and various enhancements of the model building process (e.g., objectoriented modelling).&lt;&#x2F;p&gt;
&lt;p&gt;The object-oriented paradigm for system modelling was introduced with Dymola &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#elmqvist1978&quot;&gt;6&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; to support physical system modelling based on interconnections of subsystems.
The underlying modelling language served as the basis of the first version of Modelica &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#elmquist1997&quot;&gt;7&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;, a modern equation-based modeling language which was the result of a coordinated effort for the unification and standardization of expertise gained over many years with object-oriented physical modelling.
The latest developments in this area are comprehensive model libraries for different application domains such
as mechanical, electrical, electronic, hydraulic, thermal, control, and electric power systems.
Notable commercial front-ends for Modelica are Dymola, MapleSim and SystemModeler, where the last two are tightly integrated in the symbolic computation environments Maple and Mathematica, respectively.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;numerical-software-tools&quot;&gt;Numerical software tools&lt;&#x2F;h3&gt;
&lt;p&gt;The computational tools for CACSD rely on many numerical algorithms whose development and implementation in computer codes was the primary motivation of this research area since its beginnings.
The Automatic Synthesis Program (ASP) developed in 1966 &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#kalman1966&quot;&gt;8&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;, was implemented
in FAP (Fortran Assembly Program) and ran only on an IBM 7090-7094 machine.
The Fortran II version of ASP (known as FASP) can be considered to be the first collection of computational CACSD tools ported to several mainframe computers.
Interestingly, the linear algebra computations were covered by only three routines (diagonal decomposition, inversion and pseudo-inverse) and no routines were used for eigenvalue or polynomial roots computation.
The main analysis and synthesis functions covered the sampled-data discretization (via matrix exponential), minimal realization, time-varying Riccati equation solution for quadratic control, filtering, and stability analysis.
The FASP program itself performed the required computational sequences by interpreting
simple commands with parameters.
The extensive documentation containing a detailed description of algorithmic approaches and many examples marked the starting point of an intensive research on algorithms and numerical software, which culminated in the development of the high-performance control and systems library SLICOT &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#benner1999&quot;&gt;9&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#huffel2004&quot;&gt;10&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;.
In what follows, we highlight the main achievements along this development process.
The direct successor of FASP is the Variable Dimension Automatic Synthesis Program (VASP) (implemented in Fortran IV on IBM 360) &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#white1971&quot;&gt;11&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;, while a further development was ORACLS &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#armstrong1978&quot;&gt;12&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;, which included several routines from the newly developed eigenvalue package EISPACK &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#smith1976&quot;&gt;13&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; as well as solvers for linear (Lyapunov, Sylvester) and quadratic (Riccati) matrix equations.
From this point, the mainstream development of numerical algorithms for linear system analysis and synthesis closely followed the development of algorithms and software for numerical linear algebra.
A common feature of all subsequent developments was the extensive use of robust linear algebra software with the Basic Linear Algebra Subprograms (BLAS) &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#lawson1979&quot;&gt;14&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; and the Linear Algebra Package (LINPACK) for solving linear systems &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#dongarra1979&quot;&gt;15&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;.
Several control libraries have been developed almost simultaneously, relying on the robust numerical linear algebra core software formed of BLAS, LINPACK and EISPACK.
Notable examples are:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;RASP (based partly on VASP and ORACLS) &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#grubel1983&quot;&gt;16&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; – developed originally by the University of Bochum and later by the German Aerospace Center (DLR)&lt;&#x2F;li&gt;
&lt;li&gt;BIMAS &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#varga1985&quot;&gt;17&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; and BIMASC &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#varga1986&quot;&gt;18&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; – two Romanian initiatives;&lt;&#x2F;li&gt;
&lt;li&gt;SLICOT &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#boom1991&quot;&gt;19&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; – a Benelux initiative of several universities jointly with the Numerical Algorithm Group (NAG).&lt;&#x2F;li&gt;
&lt;li&gt;The last development phase was marked by the availability of the Linear Algebra Package (LAPACK)&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#anderson1992&quot;&gt;20&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;,
whose declared goal was to make the widely used EISPACK and LINPACK libraries run efficiently on shared-memory vector and parallel processors.&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;To minimize the development efforts, several active research teams from Europe started, in the framework of the NICONET Project, a concentrated effort to develop a high-performance numerical software library for CACSD as a new significantly extended version of the original SLICOT.
The goals of the new library were to cover the main computational needs of CACSD, by relying exclusively on LAPACK and BLAS, and to guarantee similar numerical performance as that of the LAPACK routines.
The software development used rigorous standards for implementation in Fortran 77, modularization, testing, and documentation (similar to that used in LAPACK).
The development of the latest versions of RASP and SLICOT eliminated practically any duplication of efforts and led to a library which contained the best software from RASP, SLICOT, BIMAS and BIMASC.
The current version of SLICOT is fully maintained by the &lt;a href=&quot;http:&#x2F;&#x2F;www.niconet-ev.info&#x2F;en&#x2F;&quot;&gt;NICONET Association&lt;&#x2F;a&gt; and serves as basis for implementing advanced computational functions for CACSD in interactive environments as
&lt;a href=&quot;https:&#x2F;&#x2F;www.mathworks.com&quot;&gt;MATLAB&lt;&#x2F;a&gt;,
&lt;a href=&quot;http:&#x2F;&#x2F;www.maplesoft.com&#x2F;products&#x2F;maple&#x2F;&quot;&gt;Maple&lt;&#x2F;a&gt;,
&lt;a href=&quot;http:&#x2F;&#x2F;www.scilab.org&#x2F;&quot;&gt;Scilab&lt;&#x2F;a&gt; and
&lt;a href=&quot;http:&#x2F;&#x2F;www.gnu.org&#x2F;software&#x2F;octave&#x2F;&quot;&gt;Octave&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;interactive-tools&quot;&gt;Interactive tools&lt;&#x2F;h3&gt;
&lt;p&gt;Early experiments during 1970–1985 included the development of several interactive CACSD tools employing menu-driven interaction, question–answer dialogues or command languages.
The April 1982 special issue of IEEE Control Systems Magazine was dedicated to CACSD environments and presented software summaries of 20 interactive CACSD packages.
This development period was marked by the establishment of new standards for programming languages (Fortran 77, C), availability of high-quality
numerical software libraries (BLAS, EISPACK, LINPACK, ODEPACK), transition from mainframe computers to minicomputers and finally to the nowadaysubiquitous personal computers as computing platforms, spectacular developments in graphical display technologies, and application of sound programming paradigms (e.g., strong data typing).&lt;&#x2F;p&gt;
&lt;p&gt;A remarkable event in this period was the development of MATLAB, a command language based interactive matrix laboratory &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#moler1980&quot;&gt;21&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;.
The original version of MATLAB was written in Fortran 77.
It was primarily intended as a student teaching tool and provided interactive access to selected subroutines from LINPACK and EISPACK.
The tool circulated for a while in the public domain and its high flexibility was soon recognized.
Several CACSD-oriented commercial clones have been implemented in the C language, the most important among them being MATRIXx &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#walker1982&quot;&gt;22&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; and PC-MATLAB &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#moler1985&quot;&gt;23&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;.&lt;&#x2F;p&gt;
&lt;p&gt;The period after 1985 until around 2000 can be seen as a consolidation and expansion period for many commercial and non-commercial tools.
In an inventory of CACSD-related software issued by the Benelux Working Group on Software (WGS) under the auspices of the IEEE Control Systems Society, there were in 1992 in active development 70 standalone CACSD packages, 21 tools based on or similar to MATLAB, and 27 modelling&#x2F;simulation environments.
It is interesting to look more closely at the evolutions of the two main players MATRIXx and MATLAB, which took place under harshly competitive conditions.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;http:&#x2F;&#x2F;www.ni.com&#x2F;matrixx&#x2F;&quot;&gt;MATRIXx&lt;&#x2F;a&gt; with its main components Xmath, SystemBuild and AutoCode, had over many years a leading role (especially among industrial customers), excelling with a rich functionality in domains such as system identification, control system synthesis, model reduction, modelling, simulation, code generation.
After 2003, MATRIXx6 became a product of National Instruments Corporation and complements its main product family &lt;a href=&quot;http:&#x2F;&#x2F;www.ni.com&#x2F;labview&quot;&gt;LabView&lt;&#x2F;a&gt;, a visual programming language based system-design platform and development environment.&lt;&#x2F;p&gt;
&lt;p&gt;MATLAB gained broad academic acceptance by integrating many new methodological developments in the control field into several control-related
toolboxes.
MATLAB also evolved as a powerful programming language, which allows easy objectoriented manipulation of different system descriptions via operator overloading.
At present, the CACSD tools of MATLAB and Simulink represent the industrial and academic standard for CACSD.
The existing CACSD tools are constantly extended and enriched with new model classes, new computational algorithms (e.g., structure-exploiting eigenvalue computations based on SLICOT), dedicated graphical user interfaces (e.g., tuning of PID controllers or control-related visualizations), advanced robust control system synthesis, etc.
Also many thirdparty toolboxes contribute to the wide usage of this tool.&lt;&#x2F;p&gt;
&lt;p&gt;Basic CACSD functionality incorporating symbolic processing techniques and higher precision computations is available in the Maple product MapleSim Control Design Toolbox as well as in the Mathematica Control Systems product.
Free alternatives to MATLAB are the MATLAB-like environments Scilab, a French initiative pioneered by INRIA, and Octave, which has recently added some CACSD functionality.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;summary-and-future-directions&quot;&gt;Summary and Future Directions&lt;&#x2F;h2&gt;
&lt;p&gt;The development and maintenance of integrated CACSD environments, which provide support for all aspects of the CACSD cycle such as modelling, design, and simulation, involve sustained, strongly interdisciplinary efforts.
Therefore, the CACSD tool development activities must rely on the expertise of many professionals covering such diverse fields as control system engineering, programming languages and techniques, man-machine interaction, numerical methods in linear algebra and control, optimization, computer visualization, and model building techniques.
This may explain why currently, only a few of the commercial developments of prior years are still in use and actively maintained&#x2F;developed. Unfortunately, the number of actively developed noncommercial alternative products is even lower. The
dominance of MATLAB, as a de facto standard for
both industrial and academic usage of integrated tools
covering all aspects of the broader area of computer
aided control engineering (CACE), can not be overseen.
The new trends in CACSD are partly related to
handling more complex applications, involving timevarying (e.g., periodic, multi-rate sampled-data, and
differential-algebraic) linear dynamic systems, nonlinear systems with many parametric uncertainties,
and large-scale models (e.g., originating from the
discretization of PDEs). To address many computational aspects of model building (e.g., model reduction of large order systems), optimization-based
robust controller tuning using multiple-model approaches, or optimization-based robustness assessment using global-optimization techniques, parallel
computation techniques allow substantial savings in
computational times and facilitate addressing computational problems for large scale systems. A topic
which needs further research is the exploitation of the
benefits of combining numerical and symbolic computations (e.g., in model building and manipulation).&lt;&#x2F;p&gt;
&lt;h2 id=&quot;cross-references&quot;&gt;Cross-references&lt;&#x2F;h2&gt;
&lt;p&gt;CACSD software tools,
modelling and simulation,
system identification,
model reduction,
optimizationbased design,
robust synthesis,
robustness assessment,
verification and validation&lt;&#x2F;p&gt;
&lt;h2 id=&quot;recommended-reading&quot;&gt;Recommended reading&lt;&#x2F;h2&gt;
&lt;p&gt;The historical development of CACSD concepts and techniques was the subject of several articles in reference works &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#rimvall1995&quot;&gt;24&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt; &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#schmid2002&quot;&gt;25&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;.
A selection of papers on numerical algorithms underlying the development of CACSD appeared in &lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#patel1994&quot;&gt;26&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;.
The special issue No. 2&#x2F;2004 of the IEEE Control Systems Magazine on Numerical Awareness in Control presents several surveys on different aspects of developing numerical algorithms and software for CACSD.&lt;&#x2F;p&gt;
&lt;p&gt;The main trends over the last three decades in CACSD related research can be followed in the programs&#x2F;proceedings of the biannual IEEE Symposia on CACSD from 1981 to 2013 (partly available at http:&#x2F;&#x2F;ieeexplore.ieee.org) as well as of the triennial IFAC Symposia on CACSD from 1979 to 2000.
Additional information can be found in several CACSD-focused survey articles and special issues (e.g., No. 4&#x2F;1982; No. 2&#x2F;2000) of the IEEE Control Systems Magazine.&lt;&#x2F;p&gt;
&lt;div class=&quot;footnote-definition&quot; id=&quot;anderson1992&quot;&gt;&lt;sup class=&quot;footnote-definition-label&quot;&gt;20&lt;&#x2F;sup&gt;
&lt;p&gt;Anderson E, Bai Z, Bishop J, Demmel J, Du Croz J,Greenbaum A, Hammarling S, McKenney A, Ostrouchov S, Sorensen D (1992) LAPACK User’s Guide. SIAM, Philadelphia
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#armstrong1978&quot;&gt;12&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Armstrong ES (1978) ORACLS – A System for Linear-Quadratic Gaussian Control Law Design. Technical Paper 1106 96-1, NASA
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#augustin1967&quot;&gt;2&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Augustin DC, Strauss JC, Fineberg MS, Johnson BB, Linebarger RN, Sansom FJ (1967) The SCi continuous system simulation language (CSSL). Simulation 9:281–303
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#benner1999&quot;&gt;9&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Benner P, Mehrmann V, Sima V, Van Huffel S, Varga A (1999) SLICOT – a subroutine library in systems and control theory. In = Datta BN (ed) Applied and Computational Control, Signals and Circuits, vol 1,Birkhauser, pp 499–539
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#boom1991&quot;&gt;19&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Boom A, Brown A, Geurts A, Hammarling S, Kool R, Vanbegin M, Van Dooren P, Huffel SV (1991) SLICOT, a subroutine library in control and systems theory. In = Prepr. 5th IFAC&#x2F;IMACS Symp. CADCS’91, Swansea, UK, Pergamon Press, Oxford, pp 89–94
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#dongarra1979&quot;&gt;15&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Dongarra JJ, Moler CB, Bunch JR, Stewart GW (1979) LINPACK User’s Guide. SIAM Publications, Philadelphia
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#elmquist1997&quot;&gt;7&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Elmquist H et al (1997) Modelica – A Unified Object-Oriented Language for Physical Systems Modeling (Version 1). URL http:&#x2F;&#x2F;www.modelica.org&#x2F;documents&#x2F;Modelica1.pdf
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#elmqvist1978&quot;&gt;6&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Elmqvist H (1978) A structured model language for large continuous systems. PhD thesis, Department of Automatic Control, Lund University, Sweden
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#garbow1977&quot;&gt;27&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Garbow BS, Boyle JM, Dongarra JJ, Moler CB (1977) Matrix Eigensystem Routines – EISPACK Guide Extension. Springer-Verlag, Heidelberg
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#grace1991&quot;&gt;5&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Grace ACW (1991) SIMULAB, an integrated environment for simulation and control. In = Proc. of American Control Conference, Boston, MA, USA, pp 1015–1020
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#grubel1983&quot;&gt;16&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Grubel G (1983) Die regelungstechnische Programm- bibliothek RASP. Regelungstechnik 31:75–81
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#huffel2004&quot;&gt;10&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Huffel SV, Sima V, Varga A, Hammarling S, Delebecque F (2004) High-performance numerical software for control. Control Systems Magazine 24:60–76
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#kalman1966&quot;&gt;8&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Kalman RE, Englar TS (1966) A User’s Manual for the Automatic Synthesis Program (Program C). Technical Report CR-475, NASA
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#lawson1979&quot;&gt;14&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Lawson CL, Hanson RJ, Kincaid DR, Krogh FT (1979) Basic linear algebra subprograms for Fortran usage. ACM Transactions on Mathematical Software 5:308–323
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#mitchel1976&quot;&gt;3&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Mitchel EEL, Gauthier JS (1976) Advanced continuous simulation language (ACSL). Simulation 26:72–78
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#moler1980&quot;&gt;21&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Moler CB (1980) MATLAB Users’ Guide. Tech. rep., Department of Computer Science, University of New Mexico, Albuquerque, USA
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#moler1985&quot;&gt;23&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Moler CB, Little J, Bangert S, Kleinman S (1985) PCMatlab, Users’Guide, Version 2.0. Tech. rep., The MathWorks, Inc, 158 Woodland St, Sherborn, MA USA
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#nilsen1974&quot;&gt;1&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Nilsen RN, Karplus WJ (1974) Continuous-system simulation languages = A state-of-the-art survey. Mathematics and Computers in Simulation 16:17–25, DOI http:&#x2F;&#x2F;dx.doi.org&#x2F;10.1016&#x2F;S0378- 4754(74)80003-0
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#patel1994&quot;&gt;26&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Patel RV, Laub AJ, Van Dooren (Eds) P (1994) Numerical Linear Algebra Techniques for Systems and Control. IEEE Press, Piscataway, NJ, USA
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#rimvall1995&quot;&gt;24&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Rimvall C, Jobling CP (1995) Computer-Aided Control Systems Design. In = Levine WS (ed) The CONTROL HANDBOOK, CRC Press, pp 429–442
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#schmid2002&quot;&gt;25&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Schmid C (2002) Computer-Aided Control System Engineering Tools. In = Unbehauen H (ed) Control Systems, Robotics and Automation, Encyclopedia of Life Support Systems (EOLSS), URL http:&#x2F;&#x2F;www.eolss.net
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#shah1985&quot;&gt;4&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Shah CS, Floyd MA, Lehman LL (1985) MATRIXx = Control design and model building CAE capabilities. In = Jamshidi M, Herget CJ (eds) Advances in Computer Aided Control Systems Engineering, North-Holland, Elsevier Science Publishers, Amsterdam, pp 181–207
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#smith1976&quot;&gt;13&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Smith BT, Boyle JM, Dongarra JJ, Garbow BS, Ikebe Y, Klema VC, Moler CB (1976) Matrix Eigensystem Routines - EISPACK Guide, Second Edition, Lecture Notes in Computer Science, vol 6. Springer-Verlag
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#varga1986&quot;&gt;18&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Varga A, Davidoviciu A (1986) BIMASC - A package of Fortran subprograms for analysis, modelling, design and simulation of control systems. In = Hansen NE, Larsen PM (eds) Prepr. of 3rd IFAC&#x2F;IFIP Int. Symposium on Computer Aided Design in Control and Engineering (CADCE’85), Copenhagen, Denmark, Pergamon Press, Oxford, pp 151–156
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#varga1985&quot;&gt;17&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Varga A, Sima V (1985) BIMAS - A basic mathematical package for computer aided systems analysis and design. In = Gerter J, Keviczky L (eds) Prepr. of 9th IFAC World Congress, Budapest, Hungary, vol 8, pp 202–207
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#walker1982&quot;&gt;22&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: Walker R, Gregory C, Shah S (1982) MATRIXx = A data analysis, system identification, control design and simulation package. Control Systems Magazine 2:30–37
&lt;sup class=&quot;footnote-reference&quot;&gt;&lt;a href=&quot;#white1971&quot;&gt;11&lt;&#x2F;a&gt;&lt;&#x2F;sup&gt;: White JS, Lee HQ (1971) Users Manual for the Variable Automatic Synthesis Program (VASP). Technical Memorandum TM X-2417, NASA&lt;&#x2F;p&gt;
&lt;&#x2F;div&gt;
</content>
        
    </entry>
    <entry xml:lang="en">
        <title>Simulate Dynamic Matrix Control with Simupy</title>
        <published>2021-12-28T00:00:00+00:00</published>
        <updated>2021-12-28T00:00:00+00:00</updated>
        
        <author>
          <name>
            
              Unknown
            
          </name>
        </author>
        
        <link rel="alternate" type="text/html" href="https://xsro.github.io/control/dmc-with-simupy/"/>
        <id>https://xsro.github.io/control/dmc-with-simupy/</id>
        
        <content type="html" xml:base="https://xsro.github.io/control/dmc-with-simupy/">&lt;h1 id=&quot;simulate-dynamic-matrix-control-with-simupy&quot;&gt;Simulate Dynamic Matrix Control with Simupy&lt;&#x2F;h1&gt;
&lt;p&gt;I wrote some &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;xsro&#x2F;university-learning-code&#x2F;blob&#x2F;develop&#x2F;7%E9%A2%84%E6%B5%8B%E6%8E%A7%E5%88%B6&#x2F;DynamicMatrixControl&#x2F;Danamic-Matrix-Control.ipynb&quot;&gt;code&lt;&#x2F;a&gt; about the symulation of Dynamic Matirx Control with &lt;a href=&quot;https:&#x2F;&#x2F;simupy.readthedocs.io&quot;&gt;simupy&lt;&#x2F;a&gt;.&lt;&#x2F;p&gt;
&lt;blockquote&gt;
&lt;p&gt;SimuPy is a framework for simulating interconnected dynamical system models and
provides an open source, python-based tool that can be used in model- and system- based design and simulation workflows.&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;p&gt;DMC or Dynamic Matrix Control is a typical Model Predictive Control (MPC) method using the prediction of future steps to control the system.
It usually applies in process control for its requirement for matrix operation in controller.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;design-controller&quot;&gt;Design Controller&lt;&#x2F;h2&gt;
&lt;p&gt;Use the &lt;script type=&quot;math&#x2F;tex&quot;&gt;N&lt;&#x2F;script&gt;
 steps of Finite Step Response(FSR) from the given process &lt;script type=&quot;math&#x2F;tex&quot;&gt;G_p&lt;&#x2F;script&gt;
,
we can prodict the response in future &lt;script type=&quot;math&#x2F;tex&quot;&gt;P&lt;&#x2F;script&gt;
 steps,
and apply the first &lt;script type=&quot;math&#x2F;tex&quot;&gt;M&lt;&#x2F;script&gt;
 step&#x27;s result to the system.&lt;&#x2F;p&gt;
&lt;p&gt;Usually, &lt;script type=&quot;math&#x2F;tex&quot;&gt;M\le P \le N&lt;&#x2F;script&gt;
 and &lt;script type=&quot;math&#x2F;tex&quot;&gt;M=1&lt;&#x2F;script&gt;
.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;ModelPredictiveControl&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;delta_t&lt;&#x2F;span&gt;&lt;span&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;N&lt;&#x2F;span&gt;&lt;span&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;P&lt;&#x2F;span&gt;&lt;span&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;M&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    T=np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;arange&lt;&#x2F;span&gt;&lt;span&gt;(N)*delta_t
&lt;&#x2F;span&gt;&lt;span&gt;    (T,S)=control.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;step_response&lt;&#x2F;span&gt;&lt;span&gt;(Gp,T)
&lt;&#x2F;span&gt;&lt;span&gt;    Sf=np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;zeros&lt;&#x2F;span&gt;&lt;span&gt;((P,M))
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;i &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(P):
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span&gt;j &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;range&lt;&#x2F;span&gt;&lt;span&gt;(M):
&lt;&#x2F;span&gt;&lt;span&gt;            &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;i+j&amp;gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;min&lt;&#x2F;span&gt;&lt;span&gt;(M,P):
&lt;&#x2F;span&gt;&lt;span&gt;                Sf[i,j]=S[i+j-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;min&lt;&#x2F;span&gt;&lt;span&gt;(M,P)+&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    Q=np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;diagflat&lt;&#x2F;span&gt;&lt;span&gt;(np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ones&lt;&#x2F;span&gt;&lt;span&gt;((&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;,P)))
&lt;&#x2F;span&gt;&lt;span&gt;    R=np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;zeros&lt;&#x2F;span&gt;&lt;span&gt;((M,M))
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    a=(np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;dot&lt;&#x2F;span&gt;&lt;span&gt;(np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;dot&lt;&#x2F;span&gt;&lt;span&gt;(Sf.T,Q),Sf)+R)
&lt;&#x2F;span&gt;&lt;span&gt;    K=np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;dot&lt;&#x2F;span&gt;&lt;span&gt;(np.linalg.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;inv&lt;&#x2F;span&gt;&lt;span&gt;(a),np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;dot&lt;&#x2F;span&gt;&lt;span&gt;(Sf.T,Q))
&lt;&#x2F;span&gt;&lt;span&gt;    K1=K[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;,:]
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    h=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0.5&lt;&#x2F;span&gt;&lt;span&gt;*np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ones&lt;&#x2F;span&gt;&lt;span&gt;(N)
&lt;&#x2F;span&gt;&lt;span&gt;    h[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;color:#8fa1b3;&quot;&gt;MPC&lt;&#x2F;span&gt;&lt;span&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;t&lt;&#x2F;span&gt;&lt;span&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;input&lt;&#x2F;span&gt;&lt;span&gt;):
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;global &lt;&#x2F;span&gt;&lt;span&gt;lastU,y0,lastT
&lt;&#x2F;span&gt;&lt;span&gt;        [y,r]=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#96b5b4;&quot;&gt;input
&lt;&#x2F;span&gt;&lt;span&gt;        yr=np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ones&lt;&#x2F;span&gt;&lt;span&gt;((P))*r
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span&gt;t==&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;:
&lt;&#x2F;span&gt;&lt;span&gt;            lastT=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span&gt;            lastU=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span&gt;            y0=np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;zeros&lt;&#x2F;span&gt;&lt;span&gt;((N))
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;elif &lt;&#x2F;span&gt;&lt;span&gt;t&amp;gt;=lastT and t&amp;lt;lastT+delta_t:
&lt;&#x2F;span&gt;&lt;span&gt;            lastT=lastT+delta_t
&lt;&#x2F;span&gt;&lt;span&gt;            d_hat=y-y0[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;]
&lt;&#x2F;span&gt;&lt;span&gt;            y0=y0+h*d_hat
&lt;&#x2F;span&gt;&lt;span&gt;            y0[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;:-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;]=y0[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;:]
&lt;&#x2F;span&gt;&lt;span&gt;            e=yr-y0[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span&gt;:P]
&lt;&#x2F;span&gt;&lt;span&gt;            du=np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;dot&lt;&#x2F;span&gt;&lt;span&gt;(K1,e.T)
&lt;&#x2F;span&gt;&lt;span&gt;            lastU=lastU+du
&lt;&#x2F;span&gt;&lt;span&gt;            y0=y0+S*du
&lt;&#x2F;span&gt;&lt;span&gt;
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span&gt;np.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;array&lt;&#x2F;span&gt;&lt;span&gt;(lastU)
&lt;&#x2F;span&gt;&lt;span&gt;    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#b48ead;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;MPC
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;use the function returned as a callable in &lt;strong&gt;simupy&lt;&#x2F;strong&gt;. then we can connect this Block with others.&lt;&#x2F;p&gt;
&lt;pre data-lang=&quot;python&quot; style=&quot;background-color:#2b303b;color:#c0c5ce;&quot; class=&quot;language-python &quot;&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span&gt;controller=simupy.systems.&lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;SystemFromCallable&lt;&#x2F;span&gt;&lt;span&gt;(
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#bf616a;&quot;&gt;ModelPredictiveControl&lt;&#x2F;span&gt;&lt;span&gt;(delta_t,N,P,M),
&lt;&#x2F;span&gt;&lt;span&gt;        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#d08770;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span&gt;)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;h2 id=&quot;simulate-the-result&quot;&gt;Simulate the result&lt;&#x2F;h2&gt;
&lt;p&gt;By running the Code, we can know that
in this case, the more steps &lt;script type=&quot;math&#x2F;tex&quot;&gt;P&lt;&#x2F;script&gt;
 we predict,
the better performance we will get.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;images&#x2F;DMC_simlation_with_simupy.png&quot; alt=&quot;&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h2 id=&quot;references&quot;&gt;References&lt;&#x2F;h2&gt;
&lt;ul&gt;
&lt;li&gt;Siang Lim.February 2020.&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;csianglim&#x2F;DMC&#x2F;blob&#x2F;master&#x2F;DMC.ipynb&quot;&gt;Implementing Dynamic Matrix Control in Python&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;Matlab.&lt;a href=&quot;https:&#x2F;&#x2F;www.mathworks.com&#x2F;matlabcentral&#x2F;mlc-downloads&#x2F;downloads&#x2F;submissions&#x2F;19479&#x2F;versions&#x2F;1&#x2F;previews&#x2F;html&#x2F;dmctutorial.html&quot;&gt;Dynamic Matrix Control Tutorial&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</content>
        
    </entry>
</feed>
