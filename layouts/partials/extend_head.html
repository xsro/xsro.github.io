{{ if or .Page.Params.math .Site.Params.math }}
<!-- KaTeX -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css"
  integrity="sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js"
  integrity="sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js"
  integrity="sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl" crossorigin="anonymous"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    //convert back to raw for katex to render
    //This is just a solution to my habbit
    const content = document.getElementsByClassName("post-content")[0];
    content.innerHTML = content.innerHTML.replace(/\\\<br\>/g, "\\\\")
    //katex Auto-render Extension https://katex.org/docs/autorender.html
    renderMathInElement(document.body, {
      // customised options
      // • auto-render specific keys, e.g.:
      delimiters: [
        { left: '$$', right: '$$', display: true },
        { left: '$', right: '$', display: false },
      ],
      // • rendering keys, e.g.:
      throwOnError: true
    });
    document.querySelectorAll(".language-math").forEach((block) => {
      block.parentElement.innerHTML = katex.renderToString(block.innerText, {
        throwOnError: false,
        displayMode: true
      });
    });
  });
</script>
{{ end }}